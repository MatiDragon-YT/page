<!DOCTYPE html>
<html lang="es">
<head>
  <title>Links</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    const $j = $;
    let paisDetectado = '??'
    const refresh = () => window.location.href = window.location.href;

    // Función para interactuar con IndexedDB
    function openDB() {
      return new Promise((resolve, reject) => {
        const request = indexedDB.open('UserOriginDB', 1);
        request.onerror = () => reject(request.error);
        request.onsuccess = () => resolve(request.result);
        request.onupgradeneeded = event => {
          const db = event.target.result;
          db.createObjectStore('originStore', { keyPath: 'id' });
        };
      });
    }

    async function getStoredResult(db) {
      return new Promise((resolve) => {
        const transaction = db.transaction(['originStore'], 'readonly');
        const store = transaction.objectStore('originStore');
        const request = store.get('userOrigin');
        request.onsuccess = () => {
          const data = request.result;
          if (data && data.verified && Date.now() - data.timestamp < 30 * 24 * 60 * 60 * 1000) { // 30 días
            resolve(data.verified);
          } else {
            resolve(null);
          }
        };
        request.onerror = () => resolve(null);
      });
    }

    async function storeResult(db, verified) {
      return new Promise((resolve) => {
        const transaction = db.transaction(['originStore'], 'readwrite');
        const store = transaction.objectStore('originStore');
        const data = { id: 'userOrigin', verified, timestamp: Date.now() };
        const request = store.put(data);
        request.onsuccess = () => resolve();
        request.onerror = () => resolve();
      });
    }

    async function analizando() {
      // Verificar si hay un resultado almacenado en IndexedDB
      try {
        const db = await openDB();
        const storedResult = await getStoredResult(db);
        if (storedResult === true) {
          return; // Usuario ya verificado, no redirigir
        }
      } catch {
        // Si IndexedDB falla, continuar con las verificaciones
      }

      let pt = false;

      // Chequeo de idioma
      const languageCheck = () => {
        let ln = navigator.language || navigator.userLanguage || '';
        ln = ln.toLowerCase();
        const nativeLanguages = [
          'hi', // Hindi
          'ta', // Tamil
          'te', // Telugu
          'bn', // Bengalí
          'mr', // Marathi
          'gu', // Gujarati
          'kn', // Kannada
          'ml', // Malayalam
          'or', // Oriya
          'pa', // Punjabi
          'as', // Asamés
          'id', // Indonesio
          'jv', // Javanés
          'su'  // Sundanés
        ];
        return nativeLanguages.some(lang => ln.includes(lang));
      };

      // Chequeo de zona horaria
      const tzCheck = () => {
        try {
          const tz = Intl.DateTimeFormat().resolvedOptions().timeZone;
          const targetTZ = ['Asia/Kolkata', 'Asia/Jakarta', 'Asia/Makassar', 'Asia/Jayapura'];
          return targetTZ.includes(tz);
        } catch {
          return false;
        }
      };

      // Chequeo de geolocalización
      const geoCheck = () => new Promise((resolve) => {
        if (!navigator.geolocation) return resolve(false);
        navigator.geolocation.getCurrentPosition(
          pos => {
            let lat = pos.coords.latitude;
            let lon = pos.coords.longitude;
            resolve(
              (lat >= 8 && lat <= 37 && lon >= 68 && lon <= 97) || // India
              (lat >= 5.5 && lat <= 20.5 && lon >= 95.3 && lon <= 106.7) // Indonesia
            );
          },
          () => resolve(false) // No refrescar si se niega permiso
        );
      });

      // Chequeo de IP
      const ipCheck = () => new Promise(resolve => {
        $j.getJSON("https://api.ipify.org?format=json")
          .done(data => {
            $j.getJSON("https://ipapi.co/" + data.ip + "/country/")
              .done(country => {
                resolve(country === "IN" || country === "ID");
              })
              .fail(() => {
                $j.getJSON("https://freegeoip.app/json/" + data.ip)
                  .done(geo => {
                    paisDetectado = geo
                    const c = geo.country_code;
                    resolve(c === "IN" || c === "ID");
                  })
                  .fail(() => resolve(false));
              });
          })
          .fail(() => resolve(false));
      });

      // Ejecutar comprobaciones síncronas primero
      pt = languageCheck() || tzCheck();
      // Si no pasa, ejecutar comprobaciones asíncronas
      if (!pt) {
        const [geo, ip] = await Promise.all([geoCheck(), ipCheck()]);
        pt = geo || ip;
      }

      // Guardar resultado en IndexedDB
      try {
        const db = await openDB();
        await storeResult(db, pt);
      } catch {
        // Si IndexedDB falla, continuar sin almacenar
      }

      // Redirigir si no se verifica el origen
      if (!pt) {
        function detectOSAndBrowser(ua = navigator.userAgent) {
  let os = "Other";
  let browser = "Other";

  if (navigator.userAgentData) {
    const uaData = navigator.userAgentData;
    const platform = uaData.platform || "";

    // Sistema operativo
    if (/Windows/i.test(platform)) {
      os = "Windows";
    } else if (/Android/i.test(platform)) {
      os = "Android";
    } else if (/Mac/i.test(platform)) {
      os = "MacOS";
    } else if (/iPhone|iPad|iPod/i.test(platform)) {
      os = "iOS";
    } else if (/Linux/i.test(platform)) {
      os = "Linux";
    }

    // Navegador (revisamos brands o uaList)
    const brands = uaData.brands || uaData.uaList || [];
    for (const entry of brands) {
      const name = entry.brand || entry;
      if (/Edg(e)?/i.test(name)) {
        browser = "Microsoft Edge";
        break;
      }
      if (/OPR|Opera/i.test(name)) {
        browser = "Opera";
        break;
      }
      if (/Chrome/i.test(name)) {
        browser = "Google Chrome";
        break;
      }
      if (/Firefox/i.test(name)) {
        browser = "Mozilla Firefox";
        break;
      }
      if (/Safari/i.test(name)) {
        browser = "Safari";
        break;
      }
      if (/Brave/i.test(name)) {
        browser = "Brave";
        break;
      }
      if (/Vivaldi/i.test(name)) {
        browser = "Vivaldi";
        break;
      }
      if (/Samsung/i.test(name)) {
        browser = "Samsung Internet";
        break;
      }
      if (/DuckDuckGo/i.test(name)) {
        browser = "DuckDuckGo";
        break;
      }
      if (/Yandex/i.test(name)) {
        browser = "Yandex";
        break;
      }
      if (/QQBrowser/i.test(name)) {
        browser = "QQ Browser";
        break;
      }
      if (/UC/i.test(name)) {
        browser = "UC Browser";
        break;
      }
    }
  } else {
    // Fallback con navigator.userAgent
    if (/Windows NT/i.test(ua)) {
      os = "Windows";
    } else if (/Android/i.test(ua)) {
      os = "Android";
    } else if (/Mac OS X/i.test(ua)) {
      os = "MacOS";
    } else if (/iPhone|iPad|iPod/i.test(ua)) {
      os = "iOS";
    } else if (/Linux/i.test(ua)) {
      os = "Linux";
    }

    if (/Edg\/\d+/i.test(ua)) {
      browser = "Microsoft Edge";
    } else if (/OPR\/\d+/i.test(ua) || /Opera/i.test(ua)) {
      browser = "Opera";
    } else if (/Brave/i.test(ua)) {
      browser = "Brave";
    } else if (/Vivaldi/i.test(ua)) {
      browser = "Vivaldi";
    } else if (/SamsungBrowser\/\d+/i.test(ua)) {
      browser = "Samsung Internet";
    } else if (/DuckDuckGo/i.test(ua)) {
      browser = "DuckDuckGo";
    } else if (/YandexBrowser/i.test(ua)) {
      browser = "Yandex";
    } else if (/QQBrowser/i.test(ua)) {
      browser = "QQ Browser";
    } else if (/UCBrowser/i.test(ua)) {
      browser = "UC Browser";
    } else if (/Chrome\/\d+/i.test(ua) && !/Edg\/|OPR\/|Brave|Vivaldi|SamsungBrowser|DuckDuckGo|YandexBrowser|QQBrowser|UCBrowser/i.test(ua)) {
      browser = "Google Chrome";
    } else if (/Firefox\/\d+/i.test(ua)) {
      browser = "Mozilla Firefox";
    } else if (/Safari\/\d+/i.test(ua) && !/Chrome\/|Chromium\/|OPR\/|Brave|Vivaldi|SamsungBrowser|DuckDuckGo|YandexBrowser|QQBrowser|UCBrowser/i.test(ua)) {
      browser = "Safari";
    }
  }

  return { os, browser };
}


const languages = {
  aa: "Afar",
  ab: "Abjasio",
  ae: "Avéstico",
  af: "Afrikaans",
  ak: "Akan",
  am: "Amhárico",
  an: "Aragonés",
  ar: "Árabe",
  as: "Asamés",
  av: "Avar",
  ay: "Aimara",
  az: "Azerí",
  ba: "Bashkir",
  be: "Bielorruso",
  bg: "Búlgaro",
  bh: "Bihari",
  bi: "Bislama",
  bm: "Bambara",
  bn: "Bengalí",
  bo: "Tibetano",
  br: "Bretón",
  bs: "Bosnio",
  ca: "Catalán",
  ce: "Checheno",
  ch: "Chamorro",
  co: "Corso",
  cr: "Cree",
  cs: "Checo",
  cu: "Eslavo eclesiástico",
  cv: "Chuvasio",
  cy: "Galés",
  da: "Danés",
  de: "Alemán",
  dv: "Maldivo",
  dz: "Dzongkha",
  ee: "Ewé",
  el: "Griego moderno",
  en: "Inglés",
  eo: "Esperanto",
  es: "Español",
  et: "Estonio",
  eu: "Euskera",
  fa: "Persa",
  ff: "Fula",
  fi: "Finés",
  fj: "Fiyiano",
  fo: "Feroés",
  fr: "Francés",
  fy: "Frisón",
  ga: "Irlandés",
  gd: "Gaélico escocés",
  gl: "Gallego",
  gn: "Guaraní",
  gu: "Guyaratí",
  gv: "Manés",
  ha: "Hausa",
  he: "Hebreo",
  hi: "Hindi",
  ho: "Hiri Motu",
  hr: "Croata",
  ht: "Haitiano",
  hu: "Húngaro",
  hy: "Armenio",
  hz: "Herero",
  ia: "Interlingua",
  id: "Indonesio",
  ie: "Occidental",
  ig: "Igbo",
  ii: "Yi de Sichuán",
  ik: "Iñupiaq",
  io: "Ido",
  is: "Islandés",
  it: "Italiano",
  iu: "Inuktitut",
  ja: "Japonés",
  jv: "Javanés",
  ka: "Georgiano",
  kg: "Kongo",
  ki: "Kikuyu",
  kj: "Kuanyama",
  kk: "Kazajo",
  kl: "Groenlandés",
  km: "Camboyano",
  kn: "Canarés",
  ko: "Coreano",
  kr: "Kanuri",
  ks: "Cachemiro",
  ku: "Kurdo",
  kv: "Komi",
  kw: "Córnico",
  ky: "Kirguís",
  la: "Latín",
  lb: "Luxemburgués",
  lg: "Luganda",
  li: "Limburgués",
  ln: "Lingala",
  lo: "Lao",
  lt: "Lituano",
  lu: "Luba-Katanga",
  lv: "Letón",
  mg: "Malgache",
  mh: "Marshallés",
  mi: "Maorí",
  mk: "Macedonio",
  ml: "Malayalam",
  mn: "Mongol",
  mr: "Maratí",
  ms: "Malayo",
  mt: "Maltés",
  my: "Birmano",
  na: "Nauru",
  nb: "Noruego Bokmål",
  nd: "Ndebele del norte",
  ne: "Nepalí",
  ng: "Ndonga",
  nl: "Neerlandés",
  nn: "Noruego Nynorsk",
  no: "Noruego",
  nr: "Ndebele del sur",
  nv: "Navajo",
  ny: "Chichewa",
  oc: "Occitano",
  oj: "Ojibwa",
  om: "Oromo",
  or: "Oriya",
  os: "Osetio",
  pa: "Punjabi",
  pi: "Pali",
  pl: "Polaco",
  ps: "Pastún",
  pt: "Portugués",
  qu: "Quechua",
  rm: "Romanche",
  rn: "Kirundi",
  ro: "Rumano",
  ru: "Ruso",
  rw: "Kinyarwanda",
  sa: "Sánscrito",
  sc: "Sardo",
  sd: "Sindhi",
  se: "Sami del norte",
  sg: "Sango",
  si: "Cingalés",
  sk: "Eslovaco",
  sl: "Esloveno",
  sm: "Samoano",
  sn: "Shona",
  so: "Somalí",
  sq: "Albanés",
  sr: "Serbio",
  ss: "Swati",
  st: "Sotho del sur",
  su: "Sundanés",
  sv: "Sueco",
  sw: "Suajili",
  ta: "Tamil",
  te: "Telugu",
  tg: "Tayiko",
  th: "Tailandés",
  ti: "Tigrinya",
  tk: "Turcomano",
  tl: "Tagalo",
  tn: "Tswana",
  to: "Tongano",
  tr: "Turco",
  ts: "Tsonga",
  tt: "Tártaro",
  tw: "Twi",
  ty: "Tahitiano",
  ug: "Uigur",
  uk: "Ucraniano",
  ur: "Urdu",
  uz: "Uzbeko",
  ve: "Venda",
  vi: "Vietnamita",
  vo: "Volapük",
  wa: "Valón",
  wo: "Wolof",
  xh: "Xhosa",
  yi: "Yidis",
  yo: "Yoruba",
  za: "Zhuang",
  zh: "Chino",
  zu: "Zulú"
};

const countries = {
  AF: "Afganistán",
  AL: "Albania",
  DZ: "Argelia",
  AD: "Andorra",
  AO: "Angola",
  AG: "Antigua y Barbuda",
  AR: "Argentina",
  AM: "Armenia",
  AU: "Australia",
  AT: "Austria",
  AZ: "Azerbaiyán",
  BS: "Bahamas",
  BH: "Baréin",
  BD: "Bangladés",
  BB: "Barbados",
  BE: "Bélgica",
  BZ: "Belice",
  BJ: "Benín",
  BM: "Bermudas",
  BT: "Bután",
  BO: "Bolivia",
  BA: "Bosnia y Herzegovina",
  BW: "Botsuana",
  BR: "Brasil",
  BN: "Brunéi",
  BG: "Bulgaria",
  BF: "Burkina Faso",
  BI: "Burundi",
  KH: "Camboya",
  CM: "Camerún",
  CA: "Canadá",
  CV: "Cabo Verde",
  CF: "República Centroafricana",
  TD: "Chad",
  CL: "Chile",
  CN: "China",
  CO: "Colombia",
  KM: "Comoras",
  CG: "Congo",
  CD: "República Democrática del Congo",
  CR: "Costa Rica",
  HR: "Croacia",
  CU: "Cuba",
  CY: "Chipre",
  CZ: "Chequia",
  DK: "Dinamarca",
  DJ: "Yibuti",
  DM: "Dominica",
  DO: "República Dominicana",
  EC: "Ecuador",
  EG: "Egipto",
  SV: "El Salvador",
  GQ: "Guinea Ecuatorial",
  ER: "Eritrea",
  EE: "Estonia",
  SZ: "Esuatini",
  ET: "Etiopía",
  FJ: "Fiyi",
  FI: "Finlandia",
  FR: "Francia",
  GA: "Gabón",
  GM: "Gambia",
  GE: "Georgia",
  DE: "Alemania",
  GH: "Ghana",
  GR: "Grecia",
  GD: "Granada",
  GT: "Guatemala",
  GN: "Guinea",
  GW: "Guinea-Bisáu",
  GY: "Guyana",
  HT: "Haití",
  HN: "Honduras",
  HU: "Hungría",
  IS: "Islandia",
  IN: "India",
  ID: "Indonesia",
  IR: "Irán",
  IQ: "Irak",
  IE: "Irlanda",
  IL: "Israel",
  IT: "Italia",
  JM: "Jamaica",
  JP: "Japón",
  JO: "Jordania",
  KZ: "Kazajistán",
  KE: "Kenia",
  KI: "Kiribati",
  KR: "Corea del Sur",
  KW: "Kuwait",
  KG: "Kirguistán",
  LA: "Laos",
  LV: "Letonia",
  LB: "Líbano",
  LS: "Lesoto",
  LR: "Liberia",
  LY: "Libia",
  LI: "Liechtenstein",
  LT: "Lituania",
  LU: "Luxemburgo",
  MG: "Madagascar",
  MW: "Malaui",
  MY: "Malasia",
  MV: "Maldivas",
  ML: "Malí",
  MT: "Malta",
  MH: "Islas Marshall",
  MR: "Mauritania",
  MU: "Mauricio",
  MX: "México",
  FM: "Micronesia",
  MD: "Moldavia",
  MC: "Mónaco",
  MN: "Mongolia",
  ME: "Montenegro",
  MA: "Marruecos",
  MZ: "Mozambique",
  MM: "Birmania",
  NA: "Namibia",
  NR: "Nauru",
  NP: "Nepal",
  NL: "Países Bajos",
  NZ: "Nueva Zelanda",
  NI: "Nicaragua",
  NE: "Níger",
  NG: "Nigeria",
  MK: "Macedonia del Norte",
  NO: "Noruega",
  OM: "Omán",
  PK: "Pakistán",
  PW: "Palaos",
  PA: "Panamá",
  PG: "Papúa Nueva Guinea",
  PY: "Paraguay",
  PE: "Perú",
  PH: "Filipinas",
  PL: "Polonia",
  PT: "Portugal",
  QA: "Catar",
  RO: "Rumanía",
  RU: "Rusia",
  RW: "Ruanda",
  KN: "San Cristóbal y Nieves",
  LC: "Santa Lucía",
  VC: "San Vicente y las Granadinas",
  WS: "Samoa",
  SM: "San Marino",
  ST: "Santo Tomé y Príncipe",
  SA: "Arabia Saudita",
  SN: "Senegal",
  RS: "Serbia",
  SC: "Seychelles",
  SL: "Sierra Leona",
  SG: "Singapur",
  SK: "Eslovaquia",
  SI: "Eslovenia",
  SB: "Islas Salomón",
  SO: "Somalia",
  ZA: "Sudáfrica",
  ES: "España",
  LK: "Sri Lanka",
  SD: "Sudán",
  SR: "Surinam",
  SE: "Suecia",
  CH: "Suiza",
  SY: "Siria",
  TW: "Taiwán",
  TJ: "Tayikistán",
  TZ: "Tanzania",
  TH: "Tailandia",
  TL: "Timor Oriental",
  TG: "Togo",
  TO: "Tonga",
  TT: "Trinidad y Tobago",
  TN: "Túnez",
  TR: "Turquía",
  TM: "Turkmenistán",
  TV: "Tuvalu",
  UG: "Uganda",
  UA: "Ucrania",
  AE: "Emiratos Árabes Unidos",
  GB: "Reino Unido",
  US: "Estados Unidos",
  UY: "Uruguay",
  UZ: "Uzbekistán",
  VU: "Vanuatu",
  VE: "Venezuela",
  VN: "Vietnam",
  YE: "Yemen",
  ZM: "Zambia",
  ZW: "Zimbabue"
};

function getCountryName(code) {
  return countries[code.toUpperCase()] || "Código de país desconocido";
}
function getLangName(code) {
  return languages[code.toLowerCase()] || "Código de idioma desconocido";
}

function parseLocale(locale) {
  const parts = locale.split("-");
  const result = {
    lang: parts[0] ? getLangName(parts[0]) : '??',
    country: parts[1] ? getCountryName(parts[1]) : '??'
  };
  return `${result.lang}/${result.country}`;
}


const { os, browser } = detectOSAndBrowser();
const FormatoFecha = Intl.DateTimeFormat().resolvedOptions()


const ZonaHoraria = FormatoFecha.timeZone || '??';
const HoraLocal = new Date().toLocaleString() || '??';
const IdiomasSistema = FormatoFecha.locale || '??';
const IdiomasNavegador = navigator.language || navigator.userLanguage || '??';


const mensaje = `
\`\`\`js
sistema_y_navegador : '${os}/${browser}'
idioma_del_sistema : '${IdiomasSistema} (${parseLocale(IdiomasSistema)})'
idioma_del_navegador : '${IdiomasNavegador} (${parseLocale(IdiomasNavegador)})'
zona_horaria : '${ZonaHoraria}'
hora_del_sitio : '${HoraLocal}'
\`\`\`
`;




fetch('https://discord.com/api/webhooks/1410378471850381436/iFXqVmG83b5xbkkQ-Sh8YBUNQPGGJibjsR_42Vqvo0EE-avYVaQN_qvGsnNsJTJNafVA', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    username: 'Alerta de Seguridad',
    content: '',
    embeds: [
    {
      title: 'Usuario detectado',
      description: mensaje,
      color: 0x00ff00, // color verde amigable 0x
      fields: [
        {
          name: '',
          value: `-# Idiomas baneados\n-# 'id', 'hi', 'ta', 'te', 'bn', 'mr', 'gu','kn', 'ml', 'or', 'pa', 'as', 'jv', 'su'.\n-# Paises baneados\n-# 'India' y 'Indonesia'.`,
          inline: true
        }
      ],
      footer: {
        text: `by @mati_dragon`,
        icon_url: 'https://i.imgur.com/footer-icon.png'
      },
      timestamp: new Date().toISOString()
    }
  ]})
});

        //window.location.href = 'https://discord.gg/4BFQKJcCkB';
      }
    }

    analizando();
  </script>
</body>
</html>